import fs from "fs";

const FILE_NAME = "tasks.json";

function loadTasks() {
    if (!fs.existsSync(FILE_NAME)) {
        fs.writeFileSync(FILE_NAME, "[]");
        return [];
    }
    const data = fs.readFileSync(FILE_NAME, "utf-8");
    return JSON.parse(data || "[]");
}

function saveTasks(tasks) {
    fs.writeFileSync(FILE_NAME, JSON.stringify(tasks, null, 2));
}

function addTask(description) {
    const tasks = loadTasks();
    const newId = tasks.length ? Math.max(...tasks.map(t => t.taskId)) + 1 : 1;
    const now = new Date().toISOString().slice(0, 16);

    const newTask = {
        taskId: newId,
        description,
        status: "todo",
        createdAt: now,
        updatedAt: now
    };

    tasks.push(newTask);
    saveTasks(tasks);
    console.log(`task added`);
}

addTask("this task is for testing the adding function");